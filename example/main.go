package main

import (
	"encoding/hex"
	"fmt"
	"github.com/ont-bizsuite/ddxf-sdk"
	"github.com/ont-bizsuite/ddxf-sdk/example/utils"
	"github.com/ont-bizsuite/ddxf-sdk/market_place_contract"
	"github.com/ont-bizsuite/ddxf-sdk/split_policy_contract"
	"github.com/ontio/ontology-go-sdk"
	"github.com/ontio/ontology/common"
	"github.com/zhiqiangxu/ddxf"
	"io/ioutil"
	"math/rand"
	"strconv"
	"time"
)

var (
	admin         *ontology_go_sdk.Account
	seller        *ontology_go_sdk.Account
	buyer         *ontology_go_sdk.Account
	agent         *ontology_go_sdk.Account
	payer         *ontology_go_sdk.Account
	gasPrice      = uint64(2500)
	tokenTemplate *market_place_contract.TokenTemplate
)

//3f2c66242810aacc4d033758c03f182fbf31df84  split
func main() {
	testNet := "http://106.75.224.136:20336"
	testNet = ddxf_sdk.TestNet
	//testNet = "http://172.168.3.47:20336"
	//testNet = "http://113.31.112.154:20336"
	//testNet = ddxf_sdk.MainNet
	sdk := ddxf_sdk.NewDdxfSdk(testNet)
	//106.75.224.136
	wasmFile := "/Users/sss/dev/dockerData/rust_project/ddxf_market/output/marketplace.wasm"
	//wasmFile = "/Users/sss/dev/dockerData/rust_project/ddxf_market/output/dtoken.wasm"
	//wasmFile = "/Users/sss/dev/dockerData/rust_project/ddxf_market/output/data_id.wasm"
	//wasmFile = "/Users/sss/dev/dockerData/rust_project/ddxf_market/output/split_policy.wasm"
	//wasmFile = "/Users/sss/dev/rust_project/oep4-rust/output/oep_4.wasm"
	wasmFile = "/Users/sss/dev/dockerData/rust_project/ddxf_market/output/open_kg.wasm"
	//wasmFile = "/Users/sss/dev/dockerData/rust_project/ddxf_market/output/accountant.wasm"
	//wasmFile = "/Users/sss/dev/dockerData/rust_project/vote/output/vote.wasm"
	code, err := ioutil.ReadFile(wasmFile)
	if err != nil {
		fmt.Printf("error in ReadFile:%s\n", err)
		return
	}
	pwd := []byte("123456")
	ontSdk := sdk.GetOntologySdk()
	wallet, err := ontSdk.OpenWallet("./wallet.dat")
	if err != nil {
		fmt.Printf("error in ReadFile:%s\n", err)
		return
	}
	admin, _ = wallet.GetAccountByAddress("AYnhakv7kC9R5ppw65JoE2rt6xDzCjCTvD", pwd)
	seller, _ = wallet.GetAccountByAddress("Aejfo7ZX5PVpenRj23yChnyH64nf8T1zbu", pwd)
	buyer, _ = wallet.GetAccountByAddress("AHhXa11suUgVLX1ZDFErqBd3gskKqLfa5N", pwd)
	agent, _ = wallet.GetAccountByAddress("ANb3bf1b67WP2ZPh5HQt4rkrmphMJmMCMK", pwd)
	payer, _ = wallet.GetAccountByAddress("AQCQ3Krh6qxeWKKRACNehA8kAATHxoQNWJ", pwd)

	codeHex := common.ToHexString(code)
	contractAddr := common.AddressFromVmCode(code)
	fmt.Printf("contractAddr:%s, contractAddr:%s\n", contractAddr.ToBase58(), contractAddr.ToHexString())

	if false {
		code := "0061736d0100000001711160037f7f7f017f60027f7f017f60047f7f7f7f0060017f017f6000017f60017f00600e7f7f7f7f7f7f7f7f7f7f7f7f7f7f017f60027f7f0060000060037f7f7f0060057f7f7f7f7f0060037f7e7e0060027f7e0060047f7f7f7f017f60027e7f017f60017f017e60057f7f7f7f7f017f0291020b03656e76126f6e74696f5f696e7075745f6c656e677468000403656e760f6f6e74696f5f6765745f696e707574000503656e76136f6e74696f5f636865636b5f7769746e657373000303656e76166f6e74696f5f636f6e74726163745f6d696772617465000603656e760c6f6e74696f5f6e6f74696679000703656e76136f6e74696f5f63616c6c5f636f6e7472616374000003656e76186f6e74696f5f63616c6c5f6f75747075745f6c656e677468000403656e76156f6e74696f5f6765745f63616c6c5f6f7574707574000503656e76166f6e74696f5f636f6e74726163745f64657374726f79000803656e760c6f6e74696f5f72657475726e000703656e760b6f6e74696f5f70616e69630007035e5d0509090809070107070901070805020709050707070709050a090b0c020909050707010901090d0d03030807070005000101080101010e05050f100d09090001010301070201010901010701090502100501030201031005050200000004050170011e1e0504010101500608017f01418080020b070a0106696e766f6b65000e0923010041010b1d152d4b4a3e403f5053540b56393a3b3c4d4344585b5e5f6063595c5d620ab898015d02000b2400024020010d0041c78d02412b41908402100d000b20002002360204200020013602000b4601017f230041206b22032400200341146a4100360200200341e49702360210200342013702042003200136021c200320003602182003200341186a360200200320021016000bcf2105047f017e0b7f017e097f23004180026b2200240041012101024010002202450d00200041106a20024101100f2000280210220110010b200041003602202000200236021c20002001360218200041d8006a200041186a1010024002400240024002400240024002400240024002400240024002400240024020002d00584101460d00200041e0006a2802002102200028025c2101410c410110112203450d012000420c37022c20002003360228024002400240024002400240024002402002411a460d0020024107470d01200141e88302460d02200141e8830241071067450d020240200141e08702460d00200141e08702410710670d020b200041d8006a200041186a1010024020002d00584101460d00200041e0006a2802002101200028025c2102200041d8006a200041186a101220002903582204a741ff01714101460d0b200041d8006a200041186a101320002d00584101460d00200041e0006a22032802002105200028025c2106200041d8006a200041186a101320002d00584101460d0020032802002103200028025c2107200041d8006a200041186a101320002d00584101460d00200041e0006a22082802002109200028025c210a200041d8006a200041186a101320002d00584101460d0020082802002108200028025c210b200041d8006a200041186a101320002d00584101470d040b20002d005921010c0b0b200141bc8302460d03200141bc8302411a1067450d030b200041d8006a20012002101420004100200028025c20002802584101461b200041e0006a280200100c200020002903003703a001200041ec006a41013602002000420137025c200041c48402360258200041013602bc012000200041b8016a3602682000200041a0016a3602b801200041d8006a41cc84021016000b1017000b200041e0006a280200210c200028025c210d41fe86021002450d08200041a0016a41106a220e4100360200200041a0016a41086a220f4200370300200042003703a001200220012004422088a72006200520072003200a2009200b2008200d200c200041a0016a10031a200041b8016a41106a4100360200200041b8016a41086a4200370300200042003703b801200041a0016a200041b8016a41141067450d09200041d8006a1018200041d0016a200041d8006a41e0870241071019200041d0016a4102101a200041d0016a20002802d8014114101b20002802d00120002802d80122026a220120002903a001370000200141086a200f290300370000200141106a200e2802003600002000200241146a3602d801200020002802dc0141016a3602dc01200041d8006a41086a20002903d801370300200020002903d001370358200041d8006a101c200041286a4101101a0c010b200041d8006a200041186a101d20002d00584101460d09200041386a41086a200041d8006a410c6a220e28020022013602002000200029025c2204370338200041c8006a41086a2001360200200020043703480240024020010d0042002104420021100c010b2004a722092001410c6c6a2111200041d0016a41026a2112200041b8016a4102722113200041e0016a41026a2114200041d0016a41036a2115200041b8016a410472211620004180016a210f200041d0016a41016a221741066a211803402009280200210120092802082102200041003602980120002002360294012000200136029001200041b8016a20004190016a101e02400240024020002d00b8014101470d0020002d00b90121010c010b20002802c401210b20002802c001210c20002802bc01210a200041b8016a20004190016a101d20002d00b8014101460d0e200041f0016a41086a2201201641086a280200360200200020162902003703f001200041b8016a20004190016a101220002d00b8014101460d0f20002802bc012102201520002903f001370000201541086a2001280200360000200020172900003703e001200020182900003701e601200041a0016a41086a2203201441086a280100360200200020142901003703a001200020023602ac01200041b8016a20004190016a101f024020002d00b8014101460d0020002802c401210720002802c001210d20002802bc012108200041b8016a20004190016a1020200020132901003703d0012000201341066a2901003701d60120002d00b8014101470d0220002d00b901210102402007450d00200741047421032008210203400240200241046a2802002205450d0020022802002005410110210b200241106a2102200341706a22030d000b0b0240200d450d00200d4104742202450d0020082002410410210b200041a0016a1022024020002802a4012202450d002002410c6c2202450d0020002802a0012002410410210b200c450d01200a200c410110210c010b20002d00b9012101200041a0016a1022024020002802a4012202450d002002410c6c2202450d0020002802a0012002410410210b200c450d00200a200c410110210b200020013a00b80141f49402412b200041b8016a4180800241ac80021023000b200041b8016a41086a200329030022043703002001201241086a280100360200200020002903a00122103703b801200020122901003703f001200e2010370200200e41086a20043702002000200b3602602000200c36025c2000200a360258200020083602742000200d3602782000200736027c200f20002903f001370200200f41086a20012802003602004120410110112201450d0e200042203702d401200020013602d001200a200b200041d0016a102441c000410110112201450d0f200042c0003702a401200020013602a001200041b8016a200028026c2202ad4200102520002802b8012103200041a0016a20002802c0012201ad1026200041a0016a20002802a8012001101b20002802a00120002802a80122056a2003200110651a2000200520016a3602a801024020002802bc012201450d0020032001410110210b2000280264211902402002450d0020192002410c6c6a210620192101034020012802002103200041a0016a200141086a2802002202ad1026200041a0016a20002802a8012002101b20002802a00120002802a80122056a2003200210651a2000200520026a3602a8012001410c6a22012006470d000b0b200041b8016a20003502704200102520002802b8012102200041a0016a20002802c0012201ad1026200041a0016a20002802a8012001101b20002802a001220320002802a80122056a2002200110651a2000200520016a22013602a801024020002802bc012205450d0020022005410110210b200041086a20014100100f200041003602c001200020002903083703b801200041b8016a41002001101b20002802b801220220002802c00122056a2003200110651a2000200520016a22013602c001024020002802a4012205450d0020032005410110210b200041d0016a200220002802bc0120011027200041b8016a200820071028200041d0016a20002802b80120002802bc0120002802c001102741c000410110112201450d10200042c0003702a401200020013602a001200041a0016a4100101a200041a0016a4113101a200041a0016a20002802a8014113101b20002802a00120002802a80122026a220141002900809702370000200141086a410029008897023700002001410f6a410028008f97023600002000200241136a3602a80120002802d001220320002802d801200041a0016a1024200041b8016a20002802a001220520002802a801102920002802b8012201450d0320002802c001450d1120012d00002102024020002802bc012206450d0020012006410110210b200241ff01714101470d03024020002802a4012201450d0020052001410110210b024020002802d4012201450d0020032001410110210b200028028001210520002802880121014120410110112202450d12200042203702d401200020023602d001200a200b200041d0016a1024200041d0016a410141034105200141808004491b200141fd01491b101a200041d0016a2001ad102602402001450d002005200141246c6a21022005210103402001280200200141086a280200200041d0016a1024200141186a280200200141206a280200200041d0016a10242001410c6a280200200141146a280200200041d0016a1024200141246a22012002470d000b0b200041b8016a200820071028200041d0016a20002802b80120002802bc0120002802c001102741c000410110112201450d13200042c0003702a401200020013602a001200041a0016a4100101a200041a0016a4119101a200041a0016a20002802a8014119101b20002802a00120002802a80122026a220141002900b89702370000200141086a41002900c09702370000200141106a41002900c89702370000200141186a41002d00d097023a00002000200241196a3602a80120002802d001220320002802d801200041a0016a1024200041b8016a20002802a001220620002802a801102920002802b8012201450d0420002802c001450d1420012d00002102024020002802bc01220b450d002001200b410110210b200241ff01714101470d04024020002802a4012201450d0020062001410110210b024020002802d4012201450d0020032001410110210b0240200c450d00200a200c410110210b200e1022024020002802682201450d002001410c6c2201450d0020192001410410210b02402007450d00200741047421022008210103400240200141046a2802002203450d0020012802002003410110210b200141106a2101200241706a22020d000b0b0240200d450d00200d4104742201450d0020082001410410210b2009410c6a2109200f102a02402000280284012201450d00200141246c2201450d0020052001410410210b20092011470d000b42002110200035025021040b200041d8006a1018200041b8016a200041d8006a41bc8302411a1019200041b8016a4104101a200041b8016a20002802c0014110101b20002802b80120002802c00122016a22022010370008200220043700002000200141106a3602c001200020002802c40141016a3602c401200041d8006a41086a20002903c001370300200020002903b801370358200041d8006a101c200041c8006a10220240200028024c2201450d002001410c6c2201450d0020002802482001410410210b200041286a4101101a0b20002802282000280230102b000b024020002802a4012201450d0020052001410110210b024020002802d4012200450d0020032000410110210b41bc800241900141cc8102100d000b024020002802a4012201450d0020062001410110210b024020002802d4012200450d0020032000410110210b41dc810241cf0141ac8302100d000b200020002d00593a00b80141f49402412b200041b8016a4180800241d883021023000b410c4101102c000b2004420888a721010b200020013a005841f49402412b200041d8006a4180800241f083021023000b41928702412c41d08702100d000b200041dc016a4102360200200041d8006a41146a41023602002000420337025c200041e88702360258200041023602d4012000200041a0016a3602f0012000200041d0016a3602682000200041e0016a3602d8012000200041f0016a3602d0012000200041b8016a3602e001200041d8006a418088021016000b200020002d00593a00b80141f49402412b200041b8016a41808002418084021023000b200020002d00b9013a00f00141f49402412b200041f0016a41a0950241e096021023000b200020002d00b9013a00ff0141f49402412b200041ff016a41a0950241f096021023000b41204101102c000b41c0004101102c000b41c0004101102c000b4100410041a89702102e000b41204101102c000b41c0004101102c000b4100410041d49702102e000b5c00024002402001417f4c0d000240024020010d0041002101410121020c010b024002402002450d002001103321020c010b20014101101121020b2002450d020b20002002360200200020013602040f0b1035000b20014101102c000b5001017f230041106b2202240020022001104e0240024020022d00004101460d0020002001200241086a290300a710570c010b20022d00012101200041013a0000200020013a00010b200241106a24000b080020002001102f0b7501017f230041106b2202240020022001410410574101210102400240024020022d00004101460d00200241086a28020041034d0d02200041046a2002280204280000360200410021010c010b200020022d00013a00010b200020013a0000200241106a24000f0b41c49302412041ac9202100d000b870101017f230041106b220224002002200110100240024020022d00004101460d0020022002280204200241086a28020010140240024020022802004101470d00200041023a0001410121010c010b200041046a2002290204370200410021010b200020013a00000c010b20022d00012101200041013a0000200020013a00010b200241106a24000bef0704057f017e017f017e02400240024002402002450d00410020016b410020014103711b21034100200241796a2204200420024b1b210541002104034002400240200120046a2d000022064118744118752207417f4a0d004280808080802021080240200641bd88026a2d0000417e6a220941024d0d00428080808010210a0c070b0240024002400240024020090e03000102000b200441016a22062002490d024200210a0c090b4200210a200441016a220920024f0d08200120096a2d0000210902400240200641a07e6a2206410d4b0d000240024020060e0e0002020202020202020202020201000b200941e0017141a001460d02428080808010210a0c0c0b02402009411874411875417f4c0d00428080808010210a0c0c0b200941ff017141a001490d01428080808010210a0c0b0b02402007411f6a41ff0171410b4b0d0002402009411874411875417f4c0d00428080808010210a0c0c0b200941ff017141c001490d01428080808010210a0c0b0b0240200941ff017141bf014d0d00428080808010210a0c0b0b0240200741fe017141ee01460d00428080808010210a0c0b0b2009411874411875417f4c0d00428080808010210a0c0a0b42002108200441026a220620024f0d09200120066a2d000041c00171418001460d020c070b4200210a200441016a220920024f0d07200120096a2d0000210902400240200641907e6a220641044b0d000240024020060e050002020201000b200941f0006a41ff01714130490d02428080808010210a0c0b0b02402009411874411875417f4c0d00428080808010210a0c0b0b200941ff0171419001490d01428080808010210a0c0a0b0240200941ff017141bf014d0d00428080808010210a0c0a0b02402007410f6a41ff017141024d0d00428080808010210a0c0a0b2009411874411875417f4c0d00428080808010210a0c090b200441026a220620024f0d07200120066a2d000041c00171418001470d0642002108200441036a220620024f0d08200120066a2d000041c00171418001460d01428080808080e0002108428080808010210a0c080b428080808010210a200120066a2d000041c00171418001470d070b200641016a21040c010b0240200320046b4103710d000240200420054f0d000340200120046a220641046a280200200628020072418081828478710d01200441086a22042005490d000b0b200420024f0d010340200120046a2c00004100480d022002200441016a2204470d000c040b0b200441016a21040b20042002490d000b0b20002001360204200041086a2002360200200041003602000f0b428080808080c0002108428080808010210a0c010b420021080b2000200a2004ad84200884370204200041013602000b100020012000280200200028020410490b3201017f230041106b220224002002200136020c20022000360208200241d08a02360204200241e4970236020020021042000b1e00024041fe86021002450d00103d000b41928702412c41c08702100d000b880101027f0240410c4101101122010d00410c4101102c000b2000410036020c2000420c37020420002001360200200041004104101b2000280200200028020822016a41e5ecd1033600002000200141046a36020820004110101a200028020c2101200020002802084104101b2000280200200028020822026a20013600002000200241046a3602080b7d01017f20014101101a200120012802084104101b2001280200200128020822046a20033600002001200441046a2204360208200120042003101b2001280200200128020822046a2002200310651a2001200420036a3602082001200128020c41016a36020c20002001290200370200200041086a20012902083702000b3f01017f0240200028020822022000280204470d00200020024101101b200028020821020b200028020020026a20013a00002000200028020841016a3602080bcd0101027f230041206b2203240002400240024002402000280204220420016b20024f0d00200120026a22022001490d02200441017422012002200120024b1b22014108200141084b1b2101024002402004450d00200341106a41086a410136020020032004360214200320002802003602100c010b200341003602100b200320014101200341106a104f200341086a28020021012003280204210220032802004101460d0120002001360204200020023602000b200341206a24000f0b20010d010b1035000b20022001102c000b4b01037f02402000280208220141084d0d002000280204210220002802002203200028020c36000520032001100402402002450d0020032002410110210b0f0b4109200141b890021047000bf60404017f017e0a7f017e230041d0006b22022400200241306a2001104e02400240024020022d00304101460d00024002400240200241386a29030022034280082003428008541ba722040d00410421050c010b2004410c6c2206410410112205450d010b2002410036020820022004360204200220053602000240024002402003500d00200241206a41026a2107200241306a410272220841066a2109410121064100210a0340200241306a2001101e200220082901003703202002200929010037012620022d00304101460d03200241106a41086a220b200741086a2801003602002002200729010037031002402006417f6a2004470d0020042004470d00200441016a220c2004490d082004410174220d200c200d200c4b1b220c4104200c41044b1bad420c7e220e422088a745410274210c200ea7210d024002402004450d00200241043602382002200536023020022004410c6c3602340c010b200241003602300b200241c0006a200d200c200241306a104f200228024421052002280248210420022802404101460d032002200536020020022004410c6e22043602040b2005200a6a220c2002290310370200200c41086a200b280200360200200a410c6a210a20022006360208200641016a21062003427f7c220350450d000b0b200041003a0000200041046a20022903003702002000410c6a200241086a2802003602000c040b2004450d0420052004102c000b20022d00312106200041013a0000200020063a0001200210222004450d022004410c6c2206450d0220022802002006410410210c020b20064104102c000b20022d00312106200041013a0000200020063a00010b200241d0006a24000f0b1035000bc10203027f017e037f230041206b22022400200241106a2001104e02400240024020022d00104101460d0041002103200241086a200241186a29030022044280082004428008541ba74100100f200241003602182002200228020c36021420022002280208220536021002402004500d0003402001280208220620012802044f0d03200128020020066a2d000021072001200641016a360208024020032002280214470d00200241106a20034101101b20022802182103200228021021050b200520036a20073a00002002200341016a22033602182004427f7c220450450d000b0b200041003a0000200041046a20022903103702002000410c6a200241186a2802003602000c020b20022d00112103200041013a0000200020033a00010c010b200041013b010020022802142203450d0020052003410110210b200241206a24000b920604027f017e0c7f017e230041d0006b22022400200241106a2001104e024002400240024002400240024002400240024020022d00104101460d00410421030240200241186a29030022044280082004428008541ba72205450d0020054104742206410410112203450d050b200450450d01410021070c020b20022d00112106200041013a0000200020063a00010c080b200241206a41026a2108200241136a2109200241106a41016a220a41066a210b4100210c4100210d410021070340200241c0006a2001101020022d00404101460d04200228024821062002280244210e200241c0006a2001101220022d00404101460d062002280244210f200241086a20064100100f2002410036024820022002290308370340200241c0006a41002006101b2002280240200228024822106a200e200610651a200241306a41086a220e201020066a2206360200200220022903402211370330200941086a2006360000200920113700002002200a2900003703202002200b290000370126200e200841086a28010036020020022008290100370330024020072005470d00200741016a22062007490d06200c2006200c20064b1b22064104200641044b1b220641ffffffff0071200646410274211020064104742106024002402007450d00200241043602182002200d360214200220033602100c010b200241003602100b200241c0006a20062010200241106a104f200228024421032002280248211020022802404101460d03201041047621050b2003200d6a22062002290330370200200641086a200e2802003602002006410c6a200f360200200c41026a210c200d41106a210d200741016a21072004427f7c220450450d000b0b200041003a00002000410c6a2007360200200041086a2005360200200041046a20033602000c060b200321060c040b20064104102c000b200220022d00413a003041f49402412b200241306a41a0950241c096021023000b410021100c010b200220022d00413a003041f49402412b200241306a41a0950241d096021023000b02402010450d0020062010102c000b1035000b200241d0006a24000b910804017f017e117f017e230041c0016b22022400200241c0006a2001104e0240024002400240024002400240024002400240024020022d00404101460d0002400240200241c8006a29030022034280082003428008541ba722040d00410421050c010b200441246c2206410410112205450d050b200350450d01410021070c020b20022d00412106200041013a0000200020063a00010c090b200241c0006a41016a2108200241c3006a210920024180016a210a200241f4006a210b2002411a6a41026a210c4100210d4100210e410021070340200241e8006a2001101020022d00684101460d0420022802702106200228026c210f200241e8006a2001101020022d00684101460d0520022802702110200228026c2111200241e8006a2001101020022d00684101460d07200228026c211220022802702113200241106a20064100100f2002410036029801200220022903103703900120024190016a41002006101b20022802900120022802980122146a200f200610651a2002201420066a36029801200241086a20104100100f200241003602a801200220022903083703a001200241a0016a41002010101b20022802a00120022802a80122066a2011201010651a2002200620106a3602a801200220134100100f200241003602b801200220022903003703b001200241b0016a41002013101b20022802b00120022802b80122066a2012201310651a200a41086a200620136a360200200241e8006a41086a200228029801360200200b20022903a001370200200b41086a20022802a801360200200a20022903b00137020020022002290390013703682009200241e8006a412410651a2002411a6a2008412610651a200241c0006a200c412410651a024020072004470d00200741016a22062007490d07200e2006200e20064b1b22064104200641044b1bad42247e2215422088a74541027421062015a72110024002402007450d00200241043602702002200d36026c200220053602680c010b200241003602680b200241b0016a20102006200241e8006a104f20022802b401210520022802b801211020022802b0014101460d03201041246e21040b2005200d6a200241c0006a412410651a200d41246a210d200e41026a210e200741016a21072003427f7c220350450d000b0b200041003a00002000410c6a2007360200200041086a2004360200200041046a20053602000c070b200521060c050b20064104102c000b200220022d00693a00b00141f49402412b200241b0016a41a0950241b095021023000b200220022d00693a00b00141f49402412b200241b0016a41a0950241c095021023000b410021100c010b200220022d00693a00b00141f49402412b200241b0016a41a0950241d095021023000b02402010450d0020062010102c000b1035000b200241c0016a24000b0a0020002001200210300b4d01027f024020002802082201450d00200028020021002001410c6c210103400240200041046a2802002202450d0020002802002002410110210b2000410c6a2100200141746a22010d000b0b0b7d01017f230041c0006b220524002005200136020c2005200036020820052003360214200520023602102005412c6a41023602002005413c6a41033602002005420237021c200541d48e02360218200541043602342005200541306a3602282005200541106a3602382005200541086a360230200541186a20041016000b2d0020022001ad102602402001450d000340200220002d0000101a200041016a21002001417f6a22010d000b0b0b8d0301077f230041206b2203240020032002370308200320013703004100210402400240024002400240034020044170460d01200320046a21052004417f6a220621042005410f6a2d00002205450d000b20034201370310200341003602182006200541004741016a41017122046b21072006417f7320046a41114f0d04200341106a4100200320046b20066a20036b41116a2204101b20032802102208200328021822096a2003200410651a2003200920046a2204360218200741106a220920074f0d0202402003200541004741016a4101716b20066a41106a2c0000417f4a0d00024020042003280214470d00200341106a20044101101b20032802102108200328021821040b200820046a41003a00002003200441016a3602180b20002003290310370200200041086a200341106a41086a2802003602000c010b4101410110112204450d02200042818080801037020420002004360200200441003a00000b200341206a24000f0b2009411041dc8f02102e000b41014101102c000b200741116a411041f08e021047000bbd0101017f02400240200142fd01540d00200142ffff03540d0102402001428080808010540d00200041ff01101a200020002802084108101b2000280200200028020822026a20013700002000200241086a3602080f0b200041fe01101a200020002802084104101b2000280200200028020822026a20013e00002000200241046a3602080f0b20002001a7101a0f0b200041fd01101a200020002802084102101b2000280200200028020822026a20013d00002000200241026a3602080b1a00200120032000102402402002450d0020012002410110210b0bd10302057f017e230041306b22032400024041c000410110112204450d00200342c00037021420032004360210200341206a2002ad4200102520032802202105200341106a20032802282204ad1026200341106a20032802182004101b20032802102206200328021822076a2005200410651a2003200720046a2207360218024020032802242204450d0020052004410110210b02402002450d00200120024104746a2105034020012802002102200341106a200141086a2802002204ad1026200341106a20032802182004101b2003280210200328021822076a2002200410651a2003200720046a360218200341206a2001410c6a3502004200102520032802202102200341106a20032802282204ad1026200341106a20032802182004101b20032802102206200328021822076a2002200410651a2003200720046a2207360218024020032802242204450d0020022004410110210b200141106a22012005470d000b0b200341086a20074100100f200329030821082000410036020820002008370200200041002007101b2000280200200028020822016a2006200710651a2000200120076a360208024020032802142201450d0020062001410110210b200341306a24000f0b41c0004101102c000b7101027f230041106b2203240002400240419397022001200210054100480d00200341086a100622014101100f200328020c21042003280208210202402001450d00200210070b2000200436020420002002360200200041086a20013602000c010b200041003602000b200341106a24000b8e0101047f024020002802082201450d0020002802002102200141246c21034100210103400240200220016a220041046a2802002204450d0020002802002004410110210b0240200041106a2802002204450d002000410c6a2802002004410110210b02402000411c6a2802002204450d00200041186a2802002004410110210b2003200141246a2201470d000b0b0b0900200020011009000b040000000b860101017f230041306b220224002002200028020036020c200241053602142001411c6a280200210020022002410c6a360210200128021821012002412c6a4101360200200241246a41013602002002419890023602202002410136021c200241b091023602182002200241106a36022820012000200241186a10382101200241306a240020010b6b01017f230041306b2203240020032001360204200320003602002003411c6a41023602002003412c6a41063602002003420237020c200341c08a02360208200341063602242003200341206a360218200320033602282003200341046a360220200341086a20021016000b08002000200110510b0a0020002001200210520b0c00200020012002200310320b2d01017f02402003200210512204450d002004200020032001200120034b1b10651a20002001200210520b20040b0600200010340b1d01017f02402000410110512201450d0020014100200010661a0b20010b0f0041dc8402411141f08402100d000bb30101027f024002400240200041046a2802002202200028020822036b20014f0d00200320016a22012003490d01200241017422032001200320014b1b22014108200141084b1b22034100480d01024002402000280200410020021b22010d0020034101101121010c010b20022003460d00024020020d0020034101101121010c010b2001200241012003103121010b2001450d0220002001360200200041046a20033602000b0f0b1035000b20034101102c000bdc0201067f230041206b2202240020012802002103024002402001280204220441037422050d00410021060c010b200341046a2107410021060340200728020020066a2106200741086a2107200541786a22050d000b0b024002400240200141146a2802000d00200621070c010b024020040d004100410041988502102e000b410021054101210402402006410f4b0d00200341046a280200450d020b200620066a22072006490d010b02402007417f4c0d00024020070d0041002105410121040c020b2007210520074101101122040d0120074101102c000b1035000b20004100360208200020043602002000200536020420022000360204200241086a41106a200141106a290200370300200241086a41086a200141086a290200370300200220012902003703080240200241046a41a88502200241086a10380d00200241206a24000f0b41c085024133200241086a41f48502418486021023000b9b0601097f230041306b22032400200341246a2001360200200341033a00282003428080808080043703082003200036022020034100360218200341003602100240024002400240024020022802082204450d0020022802002105200228020422062002410c6a2802002207200720064b1b2207450d01200241146a280200210820022802102109200020052802002005280204200128020c1100000d03200541086a21024100210a0240024003402003200441046a28020036020c20032004411c6a2d00003a00282003200441086a280200360208200441186a280200210041002101024002400240200441146a2802000e03010002010b200020084f0d032000410374210b410021012009200b6a220b2802044107470d01200b28020028020021000b410121010b2003200036021420032001360210200441106a2802002100410021010240024002402004410c6a2802000e03010002010b200020084f0d042000410374210b2009200b6a220b2802044107470d01200b28020028020021000b410121010b2003200036021c2003200136021802402004280200220020084f0d00200920004103746a2200280200200341086a20002802041101000d07200a41016a220a20074f0d06200441206a2104200241046a210020022802002101200241086a2102200328022020012000280200200328022428020c110000450d010c070b0b2000200841848e02102e000b2000200841f48d02102e000b2000200841f48d02102e000b2002280200210520022802042206200241146a2802002204200420064b1b2207450d0020022802102104200020052802002005280204200128020c1100000d02200541086a21024100210003402004280200200341086a200441046a2802001101000d03200041016a220020074f0d02200441086a2104200241046a21012002280200210a200241086a21022003280220200a2001280200200328022428020c110000450d000c030b0b410021070b0240200620074d0d002003280220200520074103746a22042802002004280204200328022428020c1100000d010b410021040c010b410121040b200341306a240020040b02000b3401017f20002802002200200210362000280200200041086a220028020022036a2001200210651a2000200320026a36020041000bcd0201027f230041106b220224002000280200210002400240024002402001418001490d002002410036020c2001418010490d0102402001418080044f0d0020022001413f71418001723a000e20022001410c7641e001723a000c20022001410676413f71418001723a000d410321010c030b20022001413f71418001723a000f2002200141127641f001723a000c20022001410676413f71418001723a000e20022001410c76413f71418001723a000d410421010c020b024020002802082203200041046a280200470d00200041011036200028020821030b200028020020036a20013a00002000200028020841016a3602080c020b20022001413f71418001723a000d2002200141067641c001723a000c410221010b2000200110362000280200200041086a220028020022036a2002410c6a200110651a2000200320016a3602000b200241106a240041000b6201017f230041206b2202240020022000280200360204200241086a41106a200141106a290200370300200241086a41086a200141086a29020037030020022001290200370308200241046a41a88502200241086a10382101200241206a240020010b05001008000bfa0101047f230041306b22022400200028020021030240024020012d0000410471450d002001411c6a2802002104200128021821052002412c6a4100360200200241e497023602282002420137021c200241ec8f023602184101210020052004200241186a10380d010b41002100024003402002200320006a36020c2002410836021420022002410c6a36021020012802182104200128021c21052002410136022c20024101360224200241f48f023602202002410136021c200241b091023602182002200241106a36022820042005200241186a10380d01200041016a22004114470d000b410021000c010b410121000b200241306a240020000b0d0020002802001a037f0c000b0b0b002000350200200110410bcd0203027f017e037f230041306b22022400412721030240024020004290ce005a0d00200021040c010b412721030340200241096a20036a2205417c6a200020004290ce0080220442f0b17f7e7ca7220641ffff037141e4006e220741017441928b026a2f00003b00002005417e6a2007419c7f6c20066a41ffff037141017441928b026a2f00003b00002003417c6a2103200042ffc1d72f5621052004210020050d000b0b02402004a7220541e3004c0d00200241096a2003417e6a22036a2004a7220641ffff037141e4006e2205419c7f6c20066a41ffff037141017441928b026a2f00003b00000b024002402005410a480d00200241096a2003417e6a22036a200541017441928b026a2f00003b00000c010b200241096a2003417f6a22036a200541306a3a00000b200141e497024100200241096a20036a412720036b10452103200241306a240020030bc00201027f230041e0006b220124000240024002400240200028020822020d00200141003602300c010b20012002360200200141dc006a41013602002001420137024c200141b09102360248200141093602242001200141206a36025820012001360220200141306a200141c8006a103720012802300d010b20014100360208200142013703000c010b200141086a200141306a41086a280200360200200120012903303703000b200028020c22002802082102200120002902003703102001200236021c200141306a41146a4103360200200141c8006a41146a4106360200200141d4006a410136020020014203370234200141b891023602302001410a36024c2001200141c8006a36024020012001411c6a3602582001200141106a36025020012001360248200141206a200141306a1037200128022020012802281055000b02000b0c0042c487a8b2bda1b4c8480be80501067f20002802002205410171220620046a21070240024020054104710d00410021010c010b4100210802402002450d00200221092001210a03402008200a2d000041c00171418001466a2108200a41016a210a2009417f6a22090d000b0b200720026a20086b21070b412b418080c40020061b21080240024020002802084101460d004101210a200020082001200210460d012000280218200320042000411c6a28020028020c110000210a0c010b02402000410c6a280200220920074b0d004101210a200020082001200210460d012000280218200320042000411c6a28020028020c1100000f0b0240024020054108710d004100210a200920076b22092105024002400240410120002d0020220720074103461b0e0402010001020b2009410176210a200941016a41017621050c010b410021052009210a0b200a41016a210a0340200a417f6a220a450d0220002802182000280204200028021c280210110100450d000b41010f0b200028020421052000413036020420002d002021064101210a200041013a0020200020082001200210460d014100210a200920076b22092102024002400240410120002d0020220820084103461b0e0402010001020b2009410176210a200941016a41017621020c010b410021022009210a0b200a41016a210a02400340200a417f6a220a450d0120002802182000280204200028021c280210110100450d000b41010f0b200028020421094101210a200028021820032004200028021c28020c1100000d01200241016a2108200028021c210220002802182101024003402008417f6a2208450d014101210a2001200920022802101101000d030c000b0b200020063a00202000200536020441000f0b200028020421094101210a200020082001200210460d00200028021820032004200028021c28020c1100000d00200541016a2108200028021c210220002802182100034002402008417f6a22080d0041000f0b4101210a200020092002280210110100450d000b0b200a0b5401017f024002402001418080c400460d0041012104200028021820012000411c6a2802002802101101000d010b024020020d0041000f0b2000280218200220032000411c6a28020028020c11000021040b20040b6b01017f230041306b2203240020032001360204200320003602002003411c6a41023602002003412c6a41063602002003420237020c200341dc8c02360208200341063602242003200341206a3602182003200341046a36022820032003360220200341086a20021016000b6b01017f230041306b2203240020032001360204200320003602002003411c6a41023602002003412c6a41063602002003420237020c200341948d02360208200341063602242003200341206a3602182003200341046a36022820032003360220200341086a20021016000b8d07010c7f200028021021030240024002400240200028020822044101460d0020034101460d012000280218200120022000411c6a28020028020c11000021030c030b20034101470d010b0240024020020d00410021020c010b200120026a2105200041146a28020041016a21064100210720012103200121080340200341016a210902400240024020032c0000220a417f4a0d000240024020092005470d004100210b200521030c010b20032d0001413f71210b200341026a220921030b200a411f71210c0240200a41ff0171220a41df014b0d00200b200c41067472210a0c020b0240024020032005470d004100210d2005210e0c010b20032d0000413f71210d200341016a2209210e0b200d200b41067472210b0240200a41f0014f0d00200b200c410c7472210a0c020b02400240200e2005470d004100210a200921030c010b200e41016a2103200e2d0000413f71210a0b200b410674200c411274418080f0007172200a72220a418080c400470d020c040b200a41ff0171210a0b200921030b02402006417f6a2206450d00200720086b20036a21072003210820052003470d010c020b0b200a418080c400460d00024002402007450d0020072002460d0041002103200720024f0d01200120076a2c00004140480d010b200121030b2007200220031b21022003200120031b21010b20044101460d002000280218200120022000411c6a28020028020c1100000f0b4100210902402002450d002002210a200121030340200920032d000041c00171418001466a2109200341016a2103200a417f6a220a0d000b0b0240200220096b200028020c2206490d002000280218200120022000411c6a28020028020c1100000f0b410021074100210902402002450d00410021092002210a200121030340200920032d000041c00171418001466a2109200341016a2103200a417f6a220a0d000b0b200920026b20066a2209210a024002400240410020002d0020220320034103461b0e0402010001020b20094101762107200941016a410176210a0c010b4100210a200921070b200741016a2103024003402003417f6a2203450d0120002802182000280204200028021c280210110100450d000b41010f0b2000280204210941012103200028021820012002200028021c28020c1100000d00200a41016a2103200028021c210a20002802182100034002402003417f6a22030d0041000f0b20002009200a280210110100450d000b41010f0b20030b100020012000280200200028020410490b140020002802002001200028020428020c1101000b9b0101037f20002d00082101024020002802042202450d00200141ff0171210341012101024020030d00024020024101470d0020002d0009450d00200028020022032d00004104710d0041012101200328021841e68e0241012003411c6a28020028020c1100000d010b2000280200220128021841e78e0241012001411c6a28020028020c11000021010b200020013a00080b200141ff01714100470b1b00200128021841e88e0241052001411c6a28020028020c1100000bf60202037f017e230041106b22022400024002400240024002400240024002400240024002402001280208220320012802044f0d00200128020020036a2d000021042001200341016a3602080240200441837e6a220341024d0d002004ad21050c0a0b20030e03010302010b200041003a00010c070b200220014102105720022d00004101460d02200241086a28020041014d0d0320022802043300002105410321010c050b200220014108105720022d00004101460d01200241086a28020041074d0d0320022802042900002105410921010c040b20022001101220022d00004101460d0020023502042105410521010c030b200020022d00013a00010c030b41a49302412041ac9202100d000b41e49302412041ac9202100d000b0240200542fd01540d004103410541092005428080808010541b200542808004541b2001460d020b41012101200041013a00010c020b410121010c010b200041086a2005370300410021010b200020013a0000200241106a24000bd00101027f02400240024020020d004101210320012104410021010c010b0240200141004e0d0041012103410021010c020b0240024002400240200328020022040d002001450d0120012002101122040d020c030b200328020422052001460d01200341086a2802002103024020050d0002402001450d002001200310112204450d040c030b200321040c020b200420052003200110312204450d020c010b200221040b410021030c010b4101210320012104200221010b200020043602040b20002003360200200041086a20013602000b950101037f23004180016b2202240020002802002d00002103410021000340200220006a41ff006a2003410f712204413072200441d7006a2004410a491b3a00002000417f6a21002003410476410f7122030d000b024020004180016a2203418101490d00200341800141ac8e021048000b2001419490024102200220006a4180016a410020006b1045210020024180016a240020000bb40101027f230041106b220224002001410120011b210102402000450d00200041036a41027621000240200141044b0d002000417f6a220341ff014b0d00200241ac98023602042002200341027441b098026a220328020036020c200020012002410c6a200241046a41fc9702105a21012003200228020c3602000c010b200241002802ac980236020820002001200241086a41e4970241949802105a2101410020022802083602ac98020b200241106a240020010baf0101017f230041106b2203240002402000450d00200320003602042001450d000240200241044b0d00200141036a410276417f6a220041ff014b0d00200341ac98023602082003200041027441b098026a220028020036020c200341046a2003410c6a200341086a41fc970210642000200328020c3602000c010b200341002802ac980236020c200341046a2003410c6a41e497024194980210644100200328020c3602ac98020b200341106a24000b6901037f230041206b220224002001411c6a280200210320012802182104200241086a41106a2000280200220141106a290200370300200241086a41086a200141086a2902003703002002200129020037030820042003200241086a10382101200241206a240020010b100020012000280200200028020810490b090020002001100a000bc20201017f230041106b2202240002400240024002400240024020002d00000e050102030400010b2002200128021841e1910241132001411c6a28020028020c1100003a000820022001360200200241003a0009200241003602040c040b2002200128021841f49102410d2001411c6a28020028020c1100003a000820022001360200200241003a0009200241003602040c030b2002200128021841819202410d2001411c6a28020028020c1100003a000820022001360200200241003a0009200241003602040c020b20022001280218418e9202410b2001411c6a28020028020c1100003a000820022001360200200241003a0009200241003602040c010b200220012802184199920241112001411c6a28020028020c1100003a000820022001360200200241003a0009200241003602040b2002104c2101200241106a240020010b8b0101037f024002400240024020012802042203200128020822046b2002490d00200420026a22052004490d0220032005490d032001280200210320012005360208200041086a2002360200200041046a200320046a360200410021010c010b200041003a0001410121010b200020013a00000f0b20042005418494021048000b20052003418494021047000b02000b910101027f230041106b2204240020042001280200220128020036020c200241026a220220026c220241801020024180104b1b220541042004410c6a41e4970241e49702105a21022001200428020c3602000240024020020d00410121010c010b200242003702042002200220054102746a410272360200410021010b2000200236020420002001360200200441106a24000b6b01027f230041106b22052400024020002001200220032004106122060d00200541086a200320002001200428020c1102004100210620052802080d00200528020c220620022802003602082002200636020020002001200220032004106121060b200541106a240020060b02000b040020010b040041000b7701017f02400240200241027422022003410374418080016a2203200220034b1b418780046a220441107640002203417f470d0041012102410021030c010b20034110742203420037030041002102200341003602082003200320044180807c716a4102723602000b20002003360204200020023602000b05004180040b040041010bcb0401087f0240024020022802002205450d002001417f6a210620004102742107410020016b21080340200541086a210902402005280208220a410171450d0003402009200a417e71360200024002402005280204220a417c7122090d00410021010c010b4100200920092d00004101711b21010b02402005280200220b417c71220c450d004100200c200b4102711b220b450d00200b200b2802044103712009723602042005280204220a417c7121090b02402009450d00200920092802004103712005280200417c71723602002005280204210a0b2005200a41037136020420052005280200220941037136020002402009410271450d00200120012802004102723602000b20022001360200200141086a2109200121052001280208220a4101710d000b200121050b02402005280200417c71220120096b2007490d00024020092003200020042802101101004102746a41086a200120076b20087122014d0d0020062009710d0120022009280200417c71360200200521010c040b20014100360200200141786a2201420037020020012005280200417c7136020002402005280200220a417c71220b450d004100200b200a4102711b220a450d00200a200a2802044103712001723602040b200120012802044103712005723602042005200528020041037120017236020020092009280200417e7136020020052802002209410271450d0320052009417d71360200200120012802004102723602000c030b20022005280208220536020020050d000b0b41000f0b20012001280200410172360200200141086a0b02000b02000bce0201037f200028020022044100360200200441786a22002000280200417e71360200024020022003280214110300450d00024002402004417c6a2203280200417c712202450d0020022802002205410171450d010b20002802002202417c712203450d014100200320024102711b2202450d0120022d00004101710d0120042002280208417c71360200200220004101723602080f0b02400240024020002802002206417c7122040d00200221010c010b200221014100200420064102711b2206450d002006200628020441037120027236020420032802002204417c712201450d012000280200417c712104200128020021050b20012005410371200472360200200328020021040b2003200441037136020020002000280200220441037136020002402004410271450d00200220022802004102723602000b0f0b20042001280200360200200120003602000b3601017f02402002450d00200021030340200320012d00003a0000200141016a2101200341016a21032002417f6a22020d000b0b20000b2c01017f02402002450d00200021030340200320013a0000200341016a21032002417f6a22020d000b0b20000b4a01037f4100210302402002450d000240034020002d0000220420012d00002205470d01200041016a2100200141016a21012002417f6a2202450d020c000b0b200420056b21030b20030b0bb5180100418080020bac180b00000001000000010000000c000000636f6e7472616374732f646174615f69642f7372632f6c69622e7273108000001c0000001d00000017000000617373657274696f6e206661696c65643a206f6e7469643a3a7265675f69645f776974685f636f6e74726f6c6c6572287265675f69642e6f6e745f69642e61735f736c69636528292c20267265675f69642e67726f75702c0a2020202020202020202020202020202020202020202020202020202020207265675f69642e7369676e65722e61735f736c696365282929108000001c0000003300000009000000617373657274696f6e206661696c65643a206f6e7469643a3a6164645f617474726962757465735f62795f636f6e74726f6c6c6572287265675f69642e6f6e745f69642e61735f736c69636528292c0a2020202020202020202020202020202020202020202020202020202020202020202020207265675f69642e617474726962757465732e61735f736c69636528292c0a2020202020202020202020202020202020202020202020202020202020202020202020207265675f69642e7369676e65722e61735f736c69636528292900108000001c00000038000000090000007265675f69645f6164645f6174747269627574655f61727261790000108000001c000000490000002700000064657374726f7900108000001c0000005000000055000000108000001c000000540000003d000000108000001c0000005800000036000000646174615f696420636f6e7472616374206e6f7420737570706f7274206d6574686f643a2082000024000000108000001c000000590000000d0000006361706163697479206f766572666c6f77000000808200001700000017020000050000007372632f6c6962616c6c6f632f7261775f7665632e727300278300004600000068010000130000000d00000004000000040000000e0000000f000000100000006120666f726d617474696e6720747261697420696d706c656d656e746174696f6e2072657475726e656420616e206572726f72000d00000000000000010000001100000014830000130000004a0200001c0000007372632f6c6962616c6c6f632f666d742e72732f72757374632f333436616563396230326633633734663366636539376664366264613234373039643232306534392f7372632f6c6962636f72652f666d742f6d6f642e7273636f6d6d6f6e2f7372632f6c69622e7273fbe02b027e61a6d7602f26cfa9487fa58ef9ee72617373657274696f6e206661696c65643a20636865636b5f7769746e657373282673656c662e61646d696e2900006d830000110000008c000000090000006d830000110000009a000000090000006d69677261746500108400002d000000d58800000c000000f2860000010000006d830000110000009d00000009000000617373657274696f6e206661696c65643a2060286c65667420213d20726967687429600a20206c6566743a2060010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002020202020202020202020202020202020202020202020202020202020203030303030303030303030303030303040404040400000000000000000000000000006085000020000000808500001200000012000000000000000100000013000000696e646578206f7574206f6620626f756e64733a20746865206c656e20697320206275742074686520696e64657820697320303030313032303330343035303630373038303931303131313231333134313531363137313831393230323132323233323432353236323732383239333033313332333333343335333633373338333934303431343234333434343534363437343834393530353135323533353435353536353735383539363036313632363336343635363636373638363937303731373237333734373537363737373837393830383138323833383438353836383738383839393039313932393339343935393639373938393900006c860000060000007286000022000000696e64657820206f7574206f662072616e676520666f7220736c696365206f66206c656e67746820a486000016000000ba8600000d000000736c69636520696e64657820737461727473206174202062757420656e64732061742063616c6c656420604f7074696f6e3a3a756e77726170282960206f6e206120604e6f6e65602076616c7565600014870000160000005d04000024000000148700001600000053040000110000007372632f6c6962636f72652f666d742f6d6f642e727300003c8700001600000054000000140000007372632f6c6962636f72652f666d742f6e756d2e72730000e48b00000000000064870000020000003a202c294572726f72000000808700005b00000058000000200000002f55736572732f7373732f2e636172676f2f6769742f636865636b6f7574732f6f6e74696f2d63646b2d312d303732393764333264383036316135302f643331656337372f6f6e74696f2d7374642f7372632f74797065732e727300808700005b000000590000000c00000014880000020000000000000020000000080000000200000000000000000000000200000003000000307800000000000020000000040000000200000000000000020000000000000003000000488800006700000075000000260000002f55736572732f7373732f2e636172676f2f6769742f636865636b6f7574732f6f6e74696f2d63646b2d312d303732393764333264383036316135302f643331656337372f6f6e74696f2d7374642f7372632f6162692f6576656e745f6275696c6465722e727300e48b000000000000e48b000000000000d088000004000000d488000001000000206174203a602c0a2072696768743a20604c656e677468496e636f6e73697374656e6379556e6578706563746564454f464972726567756c617244617461496e76616c69645574663854797065496e636f6e73697374656e637900003c890000680000000a000000090000002f55736572732f7373732f2e7275737475702f746f6f6c636861696e732f6e696768746c792d7838365f36342d6170706c652d64617277696e2f6c69622f727573746c69622f7372632f727573742f7372632f6c6962636f72652f6d6163726f732f6d6f642e7273617373657274696f6e206661696c65643a2032203c3d206275662e6c656e2829617373657274696f6e206661696c65643a2034203c3d206275662e6c656e2829617373657274696f6e206661696c65643a2038203c3d206275662e6c656e2829148a0000600000002d0000001a0000002f55736572732f7373732f2e636172676f2f6769742f636865636b6f7574732f6f6e74696f2d63646b2d312d303732393764333264383036316135302f643331656337372f6f6e74696f2d7374642f7372632f6162692f736f757263652e727363616c6c65642060526573756c743a3a756e77726170282960206f6e20616e2060457272602076616c7565001400000001000000010000000c000000e08a00005e000000260000002c000000e08a00005e000000270000002e000000e08a00005e00000028000000330000002f55736572732f7373732f2e636172676f2f6769742f636865636b6f7574732f6f6e74696f2d63646b2d312d303732393764333264383036316135302f643331656337372f6f6e74696f2d7374642f7372632f636f6e74726163742e72730000e08a00005e0000003e0000002b000000e08a00005e0000003f0000002c000000e08a00005e0000005200000037000000e08a00005e0000005300000030000000726567494457697468436f6e74726f6c6c6572000000000000000000000000000000000000000300e08a00005e0000007700000010000000616464417474726962757465734279436f6e74726f6c6c6572000000e08a00005e0000008f000000100000001500000000000000010000001600000017000000180000001900000004000000040000001a0000001b0000001c0000001d0000000000000001000000160000001700000018000000"
		bs, _ := hex.DecodeString(code)
		add := common.AddressFromVmCode(bs)
		fmt.Println(add.ToHexString())
		return
	}

	if false {
		utils.DataIdTest(sdk, pwd, seller, contractAddr)
		return
	}

	if false {
		con := sdk.DefContract(contractAddr)
		txhash, err := con.Invoke("destroy", seller, []interface{}{})
		if err != nil {
			fmt.Println(err)
			return
		}
		evt, err := sdk.GetSmartCodeEvent(txhash.ToHexString())
		fmt.Println(evt, err)
		return
	}

	if false {
		//dtoken a2c23b928883b75092178123c1a12cdb0c46f2bd
		// mp e7de9c28a6fd5c72d576c462b49e4335f4dfdbe2
		// openkg 41b47a0ec9d8992f382cc33910a9281ea21369f7
		// split_contract 47d305e5ae4ceb736da6189224f15052f0e32357
		deployContract(sdk, seller, codeHex)
		return
	}

	if false {
		sdk.SetMpContractAddress(contractAddr)
		dtoken, _ := common.AddressFromHexString("a2c23b928883b75092178123c1a12cdb0c46f2bd")
		split, _ := common.AddressFromHexString("47d305e5ae4ceb736da6189224f15052f0e32357")
		sdk.SetGasPrice(2500)
		txHash, err := sdk.DefMpKit().Init(seller, dtoken, split)
		if err != nil {
			fmt.Println("Init failed: ", err)
			return
		}
		showNotify(sdk, "init", txHash.ToHexString())
		return
	}
	if false {
		con := sdk.DefContract(contractAddr)
		resourceId := []byte("5945133018807634517")
		res, err := con.PreInvoke("getRegisterParam", []interface{}{resourceId})
		if err != nil {
			fmt.Println(err)
			return
		}
		data, err := res.ToByteArray()
		if err != nil {
			fmt.Println(err)
			return
		}
		param := &split_policy_contract.SplitPolicyRegisterParam{}
		err = param.FromBytes(data)
		if err != nil {
			fmt.Println(err)
			return
		}
		fmt.Println(param)
		return
	}
	//openkg
	if false {
		con := sdk.DefContract(contractAddr)
		if true {
			mp, _ := common.AddressFromHexString("e7de9c28a6fd5c72d576c462b49e4335f4dfdbe2")
			dtoken, _ := common.AddressFromHexString("a2c23b928883b75092178123c1a12cdb0c46f2bd")
			utils.Init(sdk, con, seller, mp, dtoken)
			return
		}
		if true {
			resourceId := []byte("5945133018807634517")
			templateId, _ := hex.DecodeString("30")
			utils.BuyRewardAndUseToken(sdk, con, resourceId, 1, 10000000000, buyer, payer, templateId)
			return
		}
		if false {
			dtoken, _ := common.AddressFromHexString("3343753265152550e5a1741cea946436744ab442")
			utils.SetDtokenContractAddr(sdk, con, seller, dtoken)
			return
		}
		if false {
			mp, _ := common.AddressFromHexString("5fbcadf08b14aa737de8af429483dc4fb1ae13d3")
			utils.SetMpContractAddr(sdk, con, seller, mp)
			return
		}
		if true {
			resource_id := []byte("637088084609811033")
			template_id, _ := hex.DecodeString("30")
			utils.BuyAndUseToken(sdk, con, resource_id, 1, buyer, payer, template_id)
			return
		}
	}
	if false {
		sdk.DefDTokenKit().SetContractAddr(contractAddr)
		if false {
			utils.CreateTokenTemplate(sdk, seller)
			return
		}
		if false {
			utils.GenerateDtoken(sdk, seller)
			return
		}
		tokenId, _ := hex.DecodeString("31")
		if true {
			utils.BalanceOf(sdk, buyer.Address, tokenId)
			return
		}
		if err = addAgents(sdk, tokenId); err != nil {
			fmt.Println("addAgents error: ", err)
			return
		}

		//if err = useTokenByAgent(sdk, tokenId); err != nil {
		//	fmt.Println("useTokenByAgent error: ", err)
		//	return
		//}

		if err = removeAgents(sdk, tokenId); err != nil {
			fmt.Println("removeAgents error: ", err)
			return
		}

		if err = addTokenAgents(sdk, tokenId); err != nil {
			fmt.Println("addTokenAgents error: ", err)
			return
		}
		if err = removeTokenAgents(sdk); err != nil {
			fmt.Println("removeTokenAgents error: ", err)
			return
		}

		err = useToken(sdk, tokenId)
		if err != nil {
			fmt.Printf("useToken: %s\n", err)
			return
		}
		return
	}

	if true {
		sdk.DefMpKit().SetContractAddress(contractAddr)
		resourceId := strconv.Itoa(rand.Int())
		fmt.Println("resourceId:", resourceId)
		resourceIdBytes := []byte(resourceId)
		dataId := ""
		tokenTemplate = &market_place_contract.TokenTemplate{
			DataID:     dataId,
			TokenHashs: []string{string(common.UINT256_EMPTY[:])},
		}

		if err = publish(sdk, resourceIdBytes); err != nil {
			fmt.Println("publish error: ", err)
			return
		}

		//if err := delete(sdk, resourceIdBytes); err != nil {
		//	fmt.Println("delete error: ", err)
		//	return
		//}
		//return

		//if err := update(sdk, resourceIdBytes); err != nil {
		//	fmt.Println("update error: ", err)
		//	return
		//}

		//if err = buyAndUseToken(sdk, resourceIdBytes); err != nil {
		//	fmt.Println("buyAndUseToken error: ", err)
		//	return
		//}

		//if err = buyDToken(sdk, resourceIdBytes); err != nil {
		//	fmt.Println("buyDToken error: ", err)
		//	return
		//}
	}
}

func addTokenAgents(sdk *ddxf_sdk.DdxfSdk, tokenId []byte) error {
	txHash, err := sdk.DefDTokenKit().AddTokenAgents(buyer,
		[]common.Address{agent.Address}, tokenId, []int{1})
	if err != nil {
		return err
	}
	return showNotify(sdk, "addTokenAgents", txHash.ToHexString())
}

func removeTokenAgents(sdk *ddxf_sdk.DdxfSdk) error {
	txHash, err := sdk.DefDTokenKit().RemoveTokenAgents([]byte(""), buyer,
		[]common.Address{agent.Address})
	if err != nil {
		return err
	}
	return showNotify(sdk, "removeTokenAgents", txHash.ToHexString())
}

func removeAgents(sdk *ddxf_sdk.DdxfSdk, tokenId []byte) error {
	txHash, err := sdk.DefDTokenKit().RemoveAgents(buyer, []common.Address{agent.Address}, [][]byte{tokenId})
	if err != nil {
		return err
	}
	return showNotify(sdk, "removeAgents", txHash.ToHexString())
}

func useTokenByAgent(sdk *ddxf_sdk.DdxfSdk, tokenId []byte) error {

	txHash, err := sdk.DefDTokenKit().UseTokenByAgents(buyer.Address, agent, tokenId, 1)
	if err != nil {
		return err
	}
	return showNotify(sdk, "UseTokenByAgents", txHash.ToHexString())
}

func addAgents(sdk *ddxf_sdk.DdxfSdk, tokenId []byte) error {
	txHash, err := sdk.DefDTokenKit().AddAgents(buyer,
		[]common.Address{agent.Address}, []int{1}, [][]byte{tokenId})
	if err != nil {
		fmt.Printf("AddAgents: %s\n", err)
		return err
	}
	return showNotify(sdk, "addAgents", txHash.ToHexString())
}

func useToken(sdk *ddxf_sdk.DdxfSdk, tokenId []byte) error {
	txHash, err := sdk.DefDTokenKit().UseToken(seller, tokenId, 1)
	if err != nil {
		return err
	}
	return showNotify(sdk, "useToken", txHash.ToHexString())
}

//func buyAndUseToken(sdk *ddxf_sdk.DdxfSdk, resourceIdBytes []byte) error {
//	txHash, err := sdk.DefMpKit().BuyAndUseToken(buyer, payer, resourceIdBytes, 2, *tokenTemplate)
//	if err != nil {
//		return err
//	}
//	return showNotify(sdk, "buyAndUseToken", txHash.ToHexString())
//}

func buyDToken(sdk *ddxf_sdk.DdxfSdk, resourceIdBytes []byte) error {
	txHash, err := sdk.DefMpKit().BuyDToken(buyer, payer, resourceIdBytes, 10)
	if err != nil {
		return err
	}
	return showNotify(sdk, "buyDToken", txHash.ToHexString())
}

func showNotify(sdk *ddxf_sdk.DdxfSdk, method, txHash string) error {
	fmt.Printf("method: %s, txHash: %s\n", method, txHash)
	evt, err := sdk.GetSmartCodeEvent(txHash)
	if err != nil {
		return err
	}
	for _, notify := range evt.Notify {
		fmt.Printf("method: %s,evt: %v\n", method, notify)
	}
	return nil
}

func delete(sdk *ddxf_sdk.DdxfSdk, resourceIdBytes []byte) error {
	txHash, err := sdk.DefMpKit().Delete(seller, resourceIdBytes)
	if err != nil {
		fmt.Println(err)
		return err
	}
	return showNotify(sdk, "delete", txHash.ToHexString())
}
func update(sdk *ddxf_sdk.DdxfSdk, resourceIdBytes []byte) error {
	itemMeta := map[string]interface{}{
		"key": "value",
	}
	bs, err := ddxf.HashObject(itemMeta)
	if err != nil {
		return err
	}
	itemMetaHash, err := common.Uint256ParseFromBytes(bs[:])

	ddo := market_place_contract.ResourceDDO{
		Manager:      seller.Address,       // data owner id
		ItemMetaHash: itemMetaHash,         // required if len(Templates) > 1
		DTC:          []common.Address{},   // can be empty
		Accountant:   common.ADDRESS_EMPTY, // can be empty
		Split:        common.ADDRESS_EMPTY,
	}

	tokenTemplateId, _ := hex.DecodeString("30")

	item := market_place_contract.DTokenItem{
		Fee: market_place_contract.Fee{
			ContractType: 0,
			Count:        1,
		},
		ExpiredDate:      uint64(time.Now().Unix()) + 10000,
		Stocks:           10000,
		TokenTemplateIds: []string{string(tokenTemplateId)},
	}

	sp := split_policy_contract.SplitPolicyRegisterParam{
		AddrAmts: []*split_policy_contract.AddrAmt{
			&split_policy_contract.AddrAmt{
				To:          seller.Address,
				Percent:     5000,
				HasWithdraw: false,
			},
			&split_policy_contract.AddrAmt{
				To:          admin.Address,
				Percent:     5000,
				HasWithdraw: false,
			},
		},
		TokenTy: split_policy_contract.ONG,
	}

	txHash, err := sdk.DefMpKit().Update(seller, resourceIdBytes, ddo, item, sp)
	if err != nil {
		fmt.Printf("update error:%s\n", err)
		return err
	}
	fmt.Println("update txHash: ", txHash.ToHexString())

	return showNotify(sdk, "update", txHash.ToHexString())
}

func publish(sdk *ddxf_sdk.DdxfSdk, resourceIdBytes []byte) error {
	itemMeta := map[string]interface{}{
		"key": "value",
	}
	bs, err := ddxf.HashObject(itemMeta)
	if err != nil {
		return err
	}
	itemMetaHash, err := common.Uint256ParseFromBytes(bs[:])

	ddo := market_place_contract.ResourceDDO{
		Manager:      seller.Address,       // data owner id
		ItemMetaHash: itemMetaHash,         // required if len(Templates) > 1
		DTC:          []common.Address{},   // can be empty
		Accountant:   common.ADDRESS_EMPTY, // can be empty
		Split:        common.ADDRESS_EMPTY,
	}

	tokenTemplateId, _ := hex.DecodeString("30")
	item := market_place_contract.DTokenItem{
		Fee: market_place_contract.Fee{
			ContractType: 1,
			Count:        0,
		},
		ExpiredDate:      uint64(time.Now().Unix()) + 10000,
		Stocks:           10000,
		TokenTemplateIds: []string{string(tokenTemplateId)},
	}

	sp := split_policy_contract.SplitPolicyRegisterParam{
		AddrAmts: []*split_policy_contract.AddrAmt{
			&split_policy_contract.AddrAmt{
				To:          seller.Address,
				Percent:     5000,
				HasWithdraw: false,
			},
			&split_policy_contract.AddrAmt{
				To:          admin.Address,
				Percent:     5000,
				HasWithdraw: false,
			},
		},
		TokenTy: split_policy_contract.ONG,
	}

	txHash, err := sdk.DefMpKit().Publish(seller, resourceIdBytes, ddo, item, sp)
	if err != nil {
		fmt.Printf("Publish error:%s\n", err)
		return err
	}
	fmt.Println("publish txHash: ", txHash.ToHexString())
	return showNotify(sdk, "publish", txHash.ToHexString())
}

func deployContract(sdk *ddxf_sdk.DdxfSdk, admin *ontology_go_sdk.Account, codeHex string) {
	sdk.SetGasPrice(gasPrice)
	var (
		name string
		desc string
	)
	if false {
		name = "ontology-vote"
		desc = "smart contract for ontology vote"
	}
	if true {
		name = "dataid-batch"
		desc = "smart contract for ontology dataid-batch-action"
	}

	txHash, err := sdk.DeployContract(admin, codeHex, name, "0.1.1", "lucas", "", desc)
	if err != nil {
		fmt.Printf("DeployContract error:%s\n", err)
		return
	}
	evt, err := sdk.GetSmartCodeEvent(txHash.ToHexString())
	if err != nil {
		fmt.Printf("DeployContract GetSmartCodeEvent error:%s, txHash: %s\n", err, txHash.ToHexString())
		return
	}
	fmt.Println("evt:", evt)
}
